import{_ as j}from"./QuickEntryModal-ebc5f118.js";import{F as Q}from"./Fields-02fbbc9b.js";import{E as $}from"./views-5d4a0486.js";import{u as z}from"./index-b1bb6af7.js";import{m as J,i as C,l as n,j as P,x as k,z as q,k as L,r as B,b as u,c as b,d as i,w as h,e as d,t as R,u as c,g as w,p as x,D as T,Z,F as S,f as G,C as H,A as N}from"./index-8ca2d158.js";const K={class:"bg-white px-4 pb-6 pt-5 sm:px-6"},W={class:"mb-5 flex items-center justify-between"},X={class:"text-2xl font-semibold leading-6 text-gray-900"},Y={class:"flex items-center gap-1"},ee={key:0},se={class:"px-4 pb-7 pt-4 sm:px-6"},ae={class:"space-y-2"},re={__name:"AddressModal",props:J({options:{type:Object,default:{afterInsert:()=>{}}}},{modelValue:{},modelModifiers:{},address:{},addressModifiers:{}}),emits:["update:modelValue","update:address"],setup(f){const A=f,{isManager:F}=z(),t=C(f,"modelValue"),V=C(f,"address"),r=n(!1),v=n(null);n(null);const m=n(!1);let l=n({name:"",address_title:"",address_type:"Billing",address_line1:"",address_line2:"",city:"",county:"",state:"",country:"",pincode:""});const _=P(()=>{let e=m.value?__(l.value.address_title):__("New Address"),s="xl",o=[{label:m.value?__("Save"):__("Create"),variant:"solid",onClick:()=>m.value?D():O.submit()}];return{title:e,size:s,actions:o}}),E=k({url:"next_crm.ncrm.doctype.crm_fields_layout.crm_fields_layout.get_fields_layout",cache:["quickEntryFields","Address"],params:{doctype:"Address",type:"Quick Entry"},auto:!0});let y=n({});function D(){v.value=null;const e={...y.value},s={...l.value},o=JSON.stringify(e)!==JSON.stringify(s),g=s;if(!o){t.value=!1;return}r.value=!0,I.submit({doctype:"Address",name:l.value.name,fieldname:g})}const I=k({url:"frappe.client.set_value",onSuccess(e){r.value=!1,e.name&&M(e)},onError(e){r.value=!1,v.value=e}}),O=k({url:"frappe.client.insert",makeParams(){return{doc:{doctype:"Address",...l.value}}},onSuccess(e){r.value=!1,e.name&&(q("address_created"),M(e))},onError(e){r.value=!1,v.value=e}});function M(e){t.value=!1,A.options.afterInsert&&A.options.afterInsert(e)}L(()=>t.value,e=>{e&&(m.value=!1,N(()=>{var s;y.value=((s=V.value)==null?void 0:s.doc)||V.value||{},l.value={...y.value},l.value.name&&(m.value=!0)}))});const p=n(!1);function U(){p.value=!0,N(()=>{t.value=!1})}return(e,s)=>{const o=B("Button"),g=B("Dialog");return u(),b(S,null,[i(g,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=a=>t.value=a),options:_.value},{body:h(()=>[d("div",K,[d("div",W,[d("div",null,[d("h3",X,R(e.__(_.value.title)||e.__("Untitled")),1)]),d("div",Y,[c(F)()?(u(),w(o,{key:0,variant:"ghost",class:"w-7",onClick:U},{default:h(()=>[i($,{class:"h-4 w-4"})]),_:1})):x("",!0),i(o,{variant:"ghost",class:"w-7",onClick:s[0]||(s[0]=a=>t.value=!1)},{default:h(()=>[i(c(T),{name:"x",class:"h-4 w-4"})]),_:1})])]),c(E).data?(u(),b("div",ee,[i(Q,{sections:c(E).data,data:c(l)},null,8,["sections","data"]),i(c(Z),{class:"mt-2",message:v.value},null,8,["message"])])):x("",!0)]),d("div",se,[d("div",ae,[(u(!0),b(S,null,G(_.value.actions,a=>(u(),w(o,H({class:"w-full",key:a.label},a,{label:e.__(a.label),loading:r.value}),null,16,["label","loading"]))),128))])])]),_:1},8,["modelValue","options"]),p.value?(u(),w(j,{key:0,modelValue:p.value,"onUpdate:modelValue":s[2]||(s[2]=a=>p.value=a),doctype:"Address"},null,8,["modelValue"])):x("",!0)],64)}}};export{re as _};
//# sourceMappingURL=AddressModal-e11ac707.js.map
